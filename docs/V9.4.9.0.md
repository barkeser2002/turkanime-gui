# TÃ¼rkAnime Ä°ndirici v9.4.9.0 Release Notes

## Genel BakÄ±ÅŸ
v9.4.9.0 sÃ¼rÃ¼mÃ¼ bÃ¼yÃ¼k Ã§aplÄ± bir gÃ¼ncelleme olup arama motorunu Jikan (MyAnimeList) API'sine taÅŸÄ±r, FlareSolverr Cloudflare bypass entegrasyonu ekler, AniList API uyumluluÄŸunu gÃ¼nceller, thumbnail yÃ¼kleme gÃ¼venilirliÄŸini artÄ±rÄ±r ve TRAnimeÄ°zle kullanÄ±cÄ± deneyimini iyileÅŸtirir.

## SÃ¼rÃ¼m Bilgileri
- **SÃ¼rÃ¼m**: 9.4.9.0
- **Tarih**: 25 Åubat 2026
- **Tip**: MajÃ¶r Feature Release
- **Ã–nceki SÃ¼rÃ¼m**: 9.4.1

## âœ¨ Yeni Ã–zellikler ve Ä°yileÅŸtirmeler

### ğŸŒ Jikan (MyAnimeList) Arama Entegrasyonu
#### + Eklenen Ã–zellikler:
- **Jikan REST API**: Anime arama artÄ±k birincil olarak Jikan Ã¼zerinden yapÄ±lÄ±yor
- **AniList Fallback**: Jikan baÅŸarÄ±sÄ±z olursa AniList'e otomatik geÃ§iÅŸ
- **Daha Zengin SonuÃ§lar**: MAL veritabanÄ±ndan geniÅŸ anime kataloguna eriÅŸim

### ğŸ”§ FlareSolverr Cloudflare Bypass
#### + Eklenen Ã–zellikler:
- **FlareSolverr Entegrasyonu**: Uzak headless browser sunucusu ile CF bypass
- **API DesteÄŸi**: `request.get` ve `request.post` komutlarÄ±
- **Ã‡erez AktarÄ±mÄ±**: FlareSolverr'dan alÄ±nan Ã§erezler otomatik uygulanÄ±r
- **User-Agent Senkronu**: Sunucudan dÃ¶nen User-Agent saklanÄ±r
- **Ayarlanabilir URL**: FlareSolverr sunucu adresi ayarlardan deÄŸiÅŸtirilebilir

#### ~ Ä°yileÅŸtirilen Ã–zellikler:
- **Bypass Zinciri**: curl_cffi â†’ cloudscraper â†’ FlareSolverr â†’ undetected-chrome â†’ requests
- **POST DesteÄŸi**: FlareSolverr Ã¼zerinden POST istekleri de destekleniyor

### ğŸ”§ AniList API GÃ¼ncellemesi
#### ~ Ä°yileÅŸtirilen Ã–zellikler:
- **Refresh Token KaldÄ±rÄ±ldÄ±**: AniList refresh token desteklemediÄŸi iÃ§in kaldÄ±rÄ±ldÄ±
- **401 Handling**: Token sÃ¼resi dolunca kullanÄ±cÄ±ya bilgilendirme mesajÄ± gÃ¶sterilir
- **Token Ã–mrÃ¼**: AniList token'larÄ± 1 yÄ±l geÃ§erli, sÃ¼re dolunca yeniden giriÅŸ gerekir
- **Scope KaldÄ±rÄ±ldÄ±**: AniList API scope parametresi desteklemediÄŸi iÃ§in kaldÄ±rÄ±ldÄ±
- **Daha Temiz Kod**: Gereksiz retry mantÄ±ÄŸÄ± sadeleÅŸtirildi

### ğŸš€ Paralel Kaynak Arama (SearchEngine)
#### + Eklenen Ã–zellikler:
- **ThreadPoolExecutor**: Kaynaklar paralel olarak aranÄ±r (sÄ±ralÄ± dÃ¶ngÃ¼ yerine)
- **HÄ±zlÄ± SonuÃ§lar**: TÃ¼m kaynaklar aynÄ± anda sorgulanÄ±r, toplam sÃ¼re azalÄ±r

### ğŸš€ UI Performans Ä°yileÅŸtirmeleri
#### ~ Ä°yileÅŸtirilen Ã–zellikler:
- **Batch Rendering**: Anime kartlarÄ± 10'lu gruplar halinde render edilir (`after_idle`)
- **BÃ¶lÃ¼m SayÄ±sÄ±**: Sayfa baÅŸÄ±na bÃ¶lÃ¼m sayÄ±sÄ± 30'dan 15'e dÃ¼ÅŸÃ¼rÃ¼ldÃ¼
- **Background Name Check**: Ä°sim eÅŸleÅŸtirme arka planda yapÄ±lÄ±r
- **Thumbnail Retry**: Kapak gÃ¶rseli indirmede 3 deneme, 20s timeout, farklÄ± User-Agent rotasyonu

### ğŸŒ TRAnimeÄ°zle Cookie DesteÄŸi
#### + Eklenen Ã–zellikler:
- **Otomatik Cookie TarayÄ±cÄ±sÄ±**: Ä°lk aÃ§Ä±lÄ±ÅŸta cookie yoksa kullanÄ±cÄ±ya "Otomatik cookie almak ister misin?" sorusu
- **Entegre TarayÄ±cÄ± (Selenium)**: Evet denildiÄŸinde Chrome/Edge penceresi aÃ§Ä±lÄ±r, TRAnimeÄ°zle'ye yÃ¶nlendirilir
- **Captcha Ã‡Ã¶zÃ¼mÃ¼**: KullanÄ±cÄ± tarayÄ±cÄ±da captcha'yÄ± Ã§Ã¶zer, cookie'ler otomatik algÄ±lanÄ±r
- **Netscape Format**: TÃ¼m cookie'ler Netscape HTTP Cookie File formatÄ±nda kaydedilir (Ã§oklu cookie desteÄŸi)
- **Tek TÄ±kla Kaydetme**: Cookie'ler algÄ±landÄ±ÄŸÄ±nda otomatik olarak ayarlara yazÄ±lÄ±r ve anÄ±nda aktif olur
- **Manuel SeÃ§enek**: Ayarlar panelinden "ğŸŒ Otomatik Cookie Al" butonu ile her zaman tekrar Ã§alÄ±ÅŸtÄ±rÄ±labilir
- **Cookie Tutorial**: Elle almak isteyenler iÃ§in adÄ±m adÄ±m DevTools rehberi
- **Bot AlgÄ±lama KorumasÄ±**: TarayÄ±cÄ±da `webdriver` flag gizleme, automation switch'leri devre dÄ±ÅŸÄ±

### ğŸ”§ Dinamik Kaynak ButonlarÄ±
#### ~ Ä°yileÅŸtirilen Ã–zellikler:
- **Otomatik Butonlar**: Kaynak butonlarÄ± sabit kodlama yerine `sources.keys()`'den oluÅŸturulur
- **Yeni Kaynak Uyumu**: Yeni kaynak eklendiÄŸinde buton otomatik oluÅŸur

### ğŸ”§ Ä°sim EÅŸleÅŸtirme Ä°yileÅŸtirmesi
#### ~ Ä°yileÅŸtirilen Ã–zellikler:
- **DÃ¼ÅŸÃ¼k EÅŸik**: Fuzzy matching threshold 0.6'dan 0.4'e dÃ¼ÅŸÃ¼rÃ¼ldÃ¼
- **Alternatif BaÅŸlÄ±klar**: Romaji, English ve Native baÅŸlÄ±klar karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r

### ğŸ”§ Race Condition KorumasÄ±
#### + Eklenen Ã–zellikler:
- **_current_detail_request_id**: Anime detay sayfasÄ± yarÄ±ÅŸ korumasÄ±
- **_search_version**: Arama sonuÃ§larÄ± yarÄ±ÅŸ korumasÄ±

## ğŸ› DÃ¼zeltilen Hatalar

### Kritik Hatalar
- âœ… **Thumbnail Timeout**: `s4.anilist.co` read timeout hatasÄ± dÃ¼zeltildi (retry + artÄ±rÄ±lmÄ±ÅŸ timeout)
- âœ… **AniList 401 DÃ¶ngÃ¼sÃ¼**: GeÃ§ersiz refresh token ile sonsuz dÃ¶ngÃ¼ dÃ¼zeltildi
- âœ… **Race Condition**: HÄ±zlÄ± arama/detay geÃ§iÅŸlerinde eski veri gÃ¶sterimi dÃ¼zeltildi

### Kaynak DÃ¼zeltmeleri
- âœ… **Animely KaldÄ±rÄ±ldÄ±**: Kapanan kaynak tamamen temizlendi
- âœ… **TRAnimeÄ°zle Session**: Cookie tabanlÄ± oturum yÃ¶netimi eklendi

### Kod Kalitesi
- âœ… **Pylint 10.00/10**: TÃ¼m lint uyarÄ±larÄ± giderildi
- âœ… **Tip UyumsuzluklarÄ±**: 20+ lokasyondaki tip hatalarÄ± dÃ¼zeltildi
- âœ… **ABC KalÄ±tÄ±m**: Adapter sÄ±nÄ±flarÄ±nda ABC inheritance dÃ¼zeltildi
- âœ… **Ã–lÃ¼ Kod**: KullanÄ±lmayan import ve deÄŸiÅŸkenler temizlendi

## ğŸ“ DeÄŸiÅŸtirilen Dosyalar

```
turkanime_api/anilist_client.py       # ~refresh token kaldÄ±rÄ±ldÄ±, 401 handling, scope kaldÄ±rÄ±ldÄ±
turkanime_api/jikan_client.py         # +Jikan REST API client
turkanime_api/common/cf_bypass.py     # +FlareSolverr entegrasyonu, bypass zinciri gÃ¼ncellendi
turkanime_api/common/adapters.py      # ~SearchEngine paralel, Animely kaldÄ±rÄ±ldÄ±
turkanime_api/common/ui.py            # ~dinamik kaynak butonlarÄ±, batch rendering
turkanime_api/gui/main.py             # ~thumbnail retry, cookie tutorial, Jikan arama, cookie browser entegrasyonu
turkanime_api/gui/cookie_browser.py   # +Selenium entegre cookie tarayÄ±cÄ±sÄ± (CookieBrowserWorker)
turkanime_api/cli/dosyalar.py         # +flaresolverr_url, cookie_browser_prompted
turkanime_api/sources/__init__.py     # ~Animely kaldÄ±rÄ±ldÄ±
turkanime_api/sources/adapter.py      # ~ABC inheritance
turkanime_api/title_matching.py       # ~threshold 0.4, alt baÅŸlÄ±klar
README.md                             # ~gÃ¼ncel Ã¶zellikler
docs/V9.4.9.0.md                      # +Bu dosya
```

## ğŸ“ˆ Teknik Detaylar

### FlareSolverr API KullanÄ±mÄ±
```python
# GET isteÄŸi
POST http://node-kyb.bariskeser.com:8191/v1
{
    "cmd": "request.get",
    "url": "https://hedef-site.com",
    "maxTimeout": 60000
}

# YanÄ±t
{
    "status": "ok",
    "solution": {
        "url": "https://hedef-site.com",
        "status": 200,
        "cookies": [{"name": "cf_clearance", "value": "..."}],
        "userAgent": "Mozilla/5.0...",
        "response": "<!DOCTYPE html>..."
    }
}
```

### AniList Token YÃ¶netimi (GÃ¼ncellenmiÅŸ)
```python
# Eski davranÄ±ÅŸ (kaldÄ±rÄ±ldÄ±):
# refresh_access_token() â†’ refresh_token ile yenileme denendi

# Yeni davranÄ±ÅŸ:
# 401 â†’ token temizlenir, "Yeniden giriÅŸ gerekli" mesajÄ±
# Token Ã¶mrÃ¼: 1 yÄ±l
# Refresh token: AniList desteklemiyor
```

### Thumbnail Retry MantÄ±ÄŸÄ±
```python
# 3 deneme, 20s timeout, farklÄ± User-Agent
for attempt in range(3):
    headers = {"User-Agent": user_agents[attempt % len(user_agents)]}
    response = requests.get(url, timeout=20, headers=headers)
    # BaÅŸarÄ±sÄ±zsa: 1.5s * (attempt + 1) bekle
```

### Cookie TarayÄ±cÄ± AkÄ±ÅŸÄ±
```python
# 1. Ä°lk aÃ§Ä±lÄ±ÅŸ: cookie yoksa â†’ _prompt_cookie_browser()
#    "Otomatik cookie almak ister misin?" dialogu
#    cookie_browser_prompted = True (bir daha sorma)

# 2. Evet â†’ start_cookie_browser()
#    CookieBrowserWorker arka plan thread'inde Ã§alÄ±ÅŸÄ±r

# 3. Selenium Chrome/Edge aÃ§Ä±lÄ±r (headed, bot korumalÄ±)
#    - webdriver flag gizlenir
#    - automation switch'leri devre dÄ±ÅŸÄ±
#    - tranimeizle.io â†’ /anime/naruto-izle yÃ¶nlendirmesi

# 4. 2 saniye aralÄ±klarla cookie polling
#    .AitrWeb.Session algÄ±lanÄ±nca Netscape formatÄ±na Ã§evrilir

# 5. Netscape cookie â†’ txtTranimeCookie textbox + set_tranime_cookie()
#    â†’ dosya.set_ayar("tranime_cookie", netscape_str)
```

## ğŸ”„ GeÃ§iÅŸ ve Uyumluluk

### âš ï¸ Breaking Changes
- **AniList Refresh Token**: Mevcut `refresh_token` kaydÄ± artÄ±k kullanÄ±lmÄ±yor. KullanÄ±cÄ±larÄ±n yeniden giriÅŸ yapmasÄ± gerekebilir (token 1 yÄ±l geÃ§erli olduÄŸundan Ã§oÄŸu durumda etkilenmez).
- **Animely**: Kaynak tamamen kaldÄ±rÄ±ldÄ± (site kapalÄ±).

### Ã–nerilen GÃ¼ncelleme AdÄ±mlarÄ±
```bash
# GÃ¼ncelleme iÃ§in
pip install --upgrade turkanime-gui

# Veya kaynak koddan
git pull origin main
pip install -r requirements-gui.txt
```

### Yeni BaÄŸÄ±mlÄ±lÄ±klar
- FlareSolverr sunucusu (opsiyonel, `node-kyb.bariskeser.com:8191` varsayÄ±lan)
- Jikan API (harici baÄŸÄ±mlÄ±lÄ±k yok, REST Ã§aÄŸrÄ±sÄ±)

## ğŸ™ TeÅŸekkÃ¼rler

Bu sÃ¼rÃ¼m topluluk geri bildirimleri doÄŸrultusunda hazÄ±rlanmÄ±ÅŸtÄ±r. AniList API deÄŸiÅŸikliklerini bildiren, kaynak sorunlarÄ±nÄ± raporlayan ve FlareSolverr entegrasyonunu Ã¶neren herkese teÅŸekkÃ¼rler!

## ğŸ“ Destek ve Geri Bildirim
- **GitHub Issues**: [Sorun Bildir](https://github.com/barkeser2002/turkanime-gui/issues)
- **Discussions**: [Genel TartÄ±ÅŸmalar](https://github.com/barkeser2002/turkanime-gui/discussions)
- **Discord**: [Topluluk Sunucusu](https://discord.gg/tiky)

## ğŸ”— Ä°lgili BaÄŸlantÄ±lar
- **GitHub Repository**: https://github.com/barkeser2002/turkanime-gui
- **PyPI Package**: https://pypi.org/project/turkanime-gui/
- **Releases**: https://github.com/barkeser2002/turkanime-gui/releases

ğŸ‡¹ğŸ‡· **Proudly made in Turkey** ğŸ‡¹ğŸ‡·
